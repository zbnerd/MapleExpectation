spring:
  profiles:
    active: test  # âœ… ëª¨ë“  í…ŒìŠ¤íŠ¸ì—ì„œ test í”„ë¡œíŒŒì¼ í™œì„±í™”
  datasource:
    url: jdbc:h2:mem:testdb;MODE=MySQL;DB_CLOSE_DELAY=-1
    driver-class-name: org.h2.Driver
    username: sa
    password:
    hikari:
      maximum-pool-size: 5
      minimum-idle: 5
  jpa:
    hibernate:
      ddl-auto: update
    properties:
      hibernate:
        format_sql: false
        show_sql: false

management:
  endpoint:
    health:
      show-details: always
  health:
    circuitbreakers:
      enabled: true

resilience4j:
  circuitbreaker:
    configs:
      default:
        registerHealthIndicator: true
        slidingWindowSize: 10
        failureRateThreshold: 50
        waitDurationInOpenState: 10s
        permittedNumberOfCallsInHalfOpenState: 3
        # ğŸ’¡ [í•µì‹¬ ì¶”ê°€] ì´ ë§ˆì»¤ê°€ ìˆì–´ì•¼ ExternalServiceExceptionì„ ì‹¤íŒ¨ë¡œ ê¸°ë¡í•¨
        recordExceptions:
          - maple.expectation.error.exception.marker.CircuitBreakerRecordMarker
        # ğŸ’¡ [í•µì‹¬ ì¶”ê°€] ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ˆì™¸(404 ë“±)ëŠ” ì„œí‚·ì„ ì˜¤í”ˆì‹œí‚¤ì§€ ì•ŠìŒ
        ignoreExceptions:
          - maple.expectation.error.exception.marker.CircuitBreakerIgnoreMarker
    instances:
      nexonApi:
        baseConfig: default

  retry:
    instances:
      nexonApi:
        maxAttempts: 3
        waitDuration: 0ms
        # ğŸ’¡ [í•µì‹¬ ì¶”ê°€] Retryë„ ì–´ë–¤ ì˜ˆì™¸ì¼ ë•Œ ì¬ì‹œë„í• ì§€ ëª…ì‹œí•´ì•¼ í•¨
        retryExceptions:
          - maple.expectation.error.exception.ExternalServiceException

logging:
  level:
    root: info
    org.hibernate.SQL: info
    maple.expectation: info

nexon:
  api:
    key: "test_dummy_key"

alert:
  discord:
    webhook-url: "https://discord.com/api/webhooks/dummy/test"

app:
  optimization:
    use-compression: false
  aop:
    trace:
      enabled: false
  buffer:
    redis:
      enabled: false

# BYOK ì¸ì¦ ì„¤ì • (í…ŒìŠ¤íŠ¸ìš©)
auth:
  jwt:
    secret: test-secret-key-must-be-at-least-32-characters-long-for-hs256
    expiration: 1800
  fingerprint:
    secret: test-fingerprint-secret-key-for-hmac-sha256
  admin:
    allowlist: ""
  session:
    ttl: 1800

# SpringDoc ë¹„í™œì„±í™” (í…ŒìŠ¤íŠ¸)
springdoc:
  api-docs:
    enabled: false
  swagger-ui:
    enabled: false

# ğŸŸ¨ Yellow Agent Fix: í…ŒìŠ¤íŠ¸ ì‹œ ìŠ¤ì¼€ì¤„ëŸ¬ ë¹„í™œì„±í™” (Flaky Test ë°©ì§€)
scheduler:
  like-sync:
    enabled: false
  expectation-sync:
    enabled: false

# CORS ì„¤ì • (í…ŒìŠ¤íŠ¸ í™˜ê²½)
cors:
  allowed-origins:
    - "http://localhost:3000"
  allow-credentials: true
  max-age: 3600

# Cache ì„¤ì • (í…ŒìŠ¤íŠ¸ í™˜ê²½)
cache:
  specs:
    equipment:
      l1-ttl-minutes: 5
      l1-max-size: 5000
      l2-ttl-minutes: 10
      l2-serializer: json
    cubeTrials:
      l1-ttl-minutes: 10
      l1-max-size: 5000
      l2-ttl-minutes: 20
      l2-serializer: jdk
    flameTrials:
      l1-ttl-minutes: 10
      l1-max-size: 5000
      l2-ttl-minutes: 20
      l2-serializer: jdk
    ocidCache:
      l1-ttl-minutes: 30
      l1-max-size: 5000
      l2-ttl-minutes: 60
      l2-serializer: json
    characterBasic:
      l1-ttl-minutes: 15
      l1-max-size: 5000
      l2-ttl-minutes: 15
      l2-serializer: json
    expectationV4:
      l1-ttl-minutes: 60
      l1-max-size: 5000
      l2-ttl-minutes: 60
      l2-serializer: jdk
  singleflight:
    lock-wait-seconds: 5

# Expectation Buffer ì„¤ì • (í…ŒìŠ¤íŠ¸ í™˜ê²½ - ì‘ì€ ê°’ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ìš©ì´ì„± í™•ë³´)
expectation:
  buffer:
    shutdown-await-timeout-seconds: 10  # í…ŒìŠ¤íŠ¸ìš© ì§§ì€ íƒ€ì„ì•„ì›ƒ
    cas-max-retries: 10
    max-queue-size: 1000  # í…ŒìŠ¤íŠ¸ìš© ì‘ì€ í í¬ê¸°