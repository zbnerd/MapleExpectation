# MapleExpectation í…ŒìŠ¤íŠ¸ ì „ëµ ë¬¸ì„œ

## ê°œìš”

MapleExpectation í”„ë¡œì íŠ¸ì˜ í…ŒìŠ¤íŠ¸ ì „ëµì„ ì •ì˜í•©ë‹ˆë‹¤. 5ê°œ Agent(Blue, Green, Yellow, Purple, Red) ê´€ì ì—ì„œ í…ŒìŠ¤íŠ¸ ìš°ì„ ìˆœìœ„ì™€ ê²€ì¦ ê¸°ì¤€ì„ ëª…í™•íˆ í•©ë‹ˆë‹¤.

---

## 1. í…ŒìŠ¤íŠ¸ ë¶„ë¥˜ ë° ìš°ì„ ìˆœìœ„

### Priority ì •ì˜

| Priority | ì˜ë¯¸ | ë°°í¬ ì˜í–¥ | ì˜ˆì‹œ |
|----------|------|----------|------|
| **P0** | Critical - ë°°í¬ ì°¨ë‹¨ | ì´ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì‹œ ë°°í¬ ê¸ˆì§€ | CircuitBreaker ìƒíƒœ ì „ì´, ë°ì´í„° ìœ ì‹¤ |
| **P1** | High - ìŠ¤í”„ë¦°íŠ¸ ë‚´ í•´ê²° | í˜„ì¬ ìŠ¤í”„ë¦°íŠ¸ ì¢…ë£Œ ì „ ìˆ˜ì • | ì„±ëŠ¥ SLA ë¯¸ë‹¬, ë³´ì•ˆ ì·¨ì•½ì  |
| **P2** | Medium - ë°±ë¡œê·¸ ë“±ë¡ | ë‹¤ìŒ ìŠ¤í”„ë¦°íŠ¸ ê³„íš | ì½”ë“œ ìŠ¤íƒ€ì¼, ì‚¬ì†Œí•œ ìµœì í™” |
| **P3** | Low - Nice to have | ë¦¬ì†ŒìŠ¤ ì—¬ìœ  ì‹œ ì§„í–‰ | ë¬¸ì„œ ê°œì„ , ì¶”ê°€ ë¡œê¹… |

### í…ŒìŠ¤íŠ¸ ê³„ì¸µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    E2E Tests (Locust)                       â”‚
â”‚              ë¶€í•˜ í…ŒìŠ¤íŠ¸, ì „ì²´ ì‹œë‚˜ë¦¬ì˜¤ ê²€ì¦                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                Integration Tests (Testcontainers)           â”‚
â”‚           ì‹¤ì œ MySQL/Redis ì—°ë™, íŠ¸ëœì­ì…˜ ê²€ì¦                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Unit Tests (JUnit 5)                     â”‚
â”‚              ë‹¨ìœ„ ë¡œì§, Mock ê¸°ë°˜ ê²©ë¦¬ í…ŒìŠ¤íŠ¸                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. P0 í•„ìˆ˜ í…ŒìŠ¤íŠ¸ ëª©ë¡

### 2.1 CircuitBreaker í…ŒìŠ¤íŠ¸ (Red Agent)

| Test ID | í…ŒìŠ¤íŠ¸ëª… | ê²€ì¦ ëŒ€ìƒ | ì‹¤íŒ¨ ì‹œ ì˜í–¥ |
|---------|---------|----------|-------------|
| CB-P01 | CircuitBreakerIgnoreMarker_shouldNotCountFailure | ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ˆì™¸ê°€ CB ì‹¤íŒ¨ ì¹´ìš´íŠ¸ì— í¬í•¨ë˜ì§€ ì•ŠìŒ | ì •ìƒ ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ˆì™¸ë¡œ ì„œí‚· ì˜¤í”ˆ |
| CB-P02 | CircuitBreakerRecordMarker_shouldCountFailure | ì‹œìŠ¤í…œ ì˜ˆì™¸ê°€ CB ì‹¤íŒ¨ ì¹´ìš´íŠ¸ì— í¬í•¨ë¨ | ì¥ì•  ê°ì§€ ë¶ˆê°€ |
| CB-P03 | CircuitBreaker_fullCycle_CLOSED_OPEN_HALFOPEN_CLOSED | ì „ì²´ ìƒíƒœ ì „ì´ ê²€ì¦ | ì„œí‚· ì˜êµ¬ OPEN |

### 2.2 TieredCache í…ŒìŠ¤íŠ¸ (Green Agent)

| Test ID | í…ŒìŠ¤íŠ¸ëª… | ê²€ì¦ ëŒ€ìƒ | ì‹¤íŒ¨ ì‹œ ì˜í–¥ |
|---------|---------|----------|-------------|
| TC-P01 | TieredCache_singleFlight_onlyOneLoaderExecution | 100ê°œ ë™ì‹œ ìš”ì²­ ì‹œ loader 1íšŒ ì‹¤í–‰ | Cache Stampede |
| TC-P02 | TieredCache_writeOrder_L2ThenL1 | L2 ì €ì¥ â†’ L1 ì €ì¥ ìˆœì„œ | ë°ì´í„° ë¶ˆì¼ì¹˜ |

### 2.3 AsyncPipeline í…ŒìŠ¤íŠ¸ (Green Agent)

| Test ID | í…ŒìŠ¤íŠ¸ëª… | ê²€ì¦ ëŒ€ìƒ | ì‹¤íŒ¨ ì‹œ ì˜í–¥ |
|---------|---------|----------|-------------|
| AP-P01 | AsyncPipeline_queueFull_returns503 | Executor í í¬í™” ì‹œ 503 ë°˜í™˜ | í†°ìº£ ìŠ¤ë ˆë“œ ê³ ê°ˆ |

### 2.4 GracefulShutdown í…ŒìŠ¤íŠ¸ (Red Agent)

| Test ID | í…ŒìŠ¤íŠ¸ëª… | ê²€ì¦ ëŒ€ìƒ | ì‹¤íŒ¨ ì‹œ ì˜í–¥ |
|---------|---------|----------|-------------|
| GS-P01 | GracefulShutdown_flushesBuffers | ì¢…ë£Œ ì‹œ ë²„í¼ ë°ì´í„° ì˜ì†í™” | ë°ì´í„° ìœ ì‹¤ |

---

## 3. ì‹¤íŒ¨ ì •ì˜ (ì´ë¬´ ê´€ì )

### 3.1 ë¶€í•˜ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ê¸°ì¤€

| ì§€í‘œ | ì„ê³„ê°’ | ì‹¤íŒ¨ ì‹œ ì•¡ì…˜ |
|------|--------|-------------|
| **Error Rate** | > 1% | P0 - ë°°í¬ ì°¨ë‹¨ |
| **P95 Latency** | > 3000ms | P1 - ì„±ëŠ¥ ìµœì í™” |
| **P99 Latency** | > 5000ms | P1 - ë³‘ëª© ë¶„ì„ |
| **RPS** | < 100 (ëª©í‘œ ëŒ€ë¹„ 50% ë¯¸ë§Œ) | P1 - ìŠ¤ì¼€ì¼ë§ ê²€í†  |

### 3.2 ë‹¨ìœ„/í†µí•© í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ê¸°ì¤€

| í•­ëª© | ê¸°ì¤€ | ì‹¤íŒ¨ ì‹œ |
|------|------|--------|
| **í…ŒìŠ¤íŠ¸ í†µê³¼ìœ¨** | 100% | ë¨¸ì§€ ì°¨ë‹¨ |
| **ì»¤ë²„ë¦¬ì§€** | > 70% (í•µì‹¬ ëª¨ë“ˆ > 90%) | ë¦¬ë·° ê²½ê³  |
| **Flaky Test** | ë™ì¼ ì½”ë“œ 3íšŒ ì‹¤í–‰ ì¤‘ 1íšŒ ì´ìƒ ì‹¤íŒ¨ | ì¦‰ì‹œ ìˆ˜ì • |

### 3.3 ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤íŒ¨ ë¶„ë¥˜

| ë¶„ë¥˜ | ì˜ˆì‹œ | í…ŒìŠ¤íŠ¸ ì·¨ê¸‰ |
|------|------|------------|
| **ì˜ˆìƒëœ ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ˆì™¸** | DuplicateLikeException, SelfLikeNotAllowedException | ì„±ê³µ ì²˜ë¦¬ |
| **ë¹„ì •ìƒ ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ˆì™¸** | NullPointerException, IllegalStateException | ì‹¤íŒ¨ ì²˜ë¦¬ |
| **ì¸í”„ë¼ ì˜ˆì™¸** | RedisConnectionFailureException | ì‹¤íŒ¨ ì²˜ë¦¬ (ì„œí‚·ë¸Œë ˆì´ì»¤ ë™ì‘) |

### 3.4 Cache Stampede ê²€ì¦ ê¸°ì¤€ ê°•í™”

| ì§€í‘œ | Before | After | ì´ìœ  |
|------|--------|-------|------|
| DB ì¿¼ë¦¬ ë¹„ìœ¨ | â‰¤ 10% | â‰¤ 1% | Singleflight íš¨ê³¼ ì¸¡ì • ì •ë°€í™” |
| ë™ì‹œ ë¡œë“œ ì‹¤í–‰ ìˆ˜ | â‰¤ 5íšŒ | 1íšŒ | Cache Stampede ì™„ì „ ë°©ì§€ |
| L1â†’L2â†’DB í­í¬ ë°œìƒ | í—ˆìš© | ê¸ˆì§€ | ê³„ì¸µë³„ ë™ì‹œì„± ì œì–´ ê²€ì¦ |

---

## 4. ì¬í˜„ì„± ë³´ì¥

### 4.1 ë¶€í•˜ í…ŒìŠ¤íŠ¸ í™˜ê²½ ê³ ì •

```yaml
# locust/scenario.yml (ì˜ˆì‹œ)
environment:
  jvm:
    heap: "-Xmx512m -Xms512m"
    gc: "-XX:+UseG1GC"
  redis:
    maxmemory: "256mb"
    maxmemory-policy: "allkeys-lru"
  mysql:
    innodb_buffer_pool_size: "128M"

test_parameters:
  users: 50
  spawn_rate: 10
  duration: "60s"
  warmup_duration: "10s"

cache_state:
  before_test: "cold"  # or "warm"
  warmup_characters: ["ê°•ì€í˜¸", "ì•„ë¸"]
```

### 4.2 í…ŒìŠ¤íŠ¸ ë°ì´í„° ê²©ë¦¬

```java
// í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ë§ˆë‹¤ ê³ ìœ  í‚¤ ì‚¬ìš©
String testKey = "test-" + UUID.randomUUID();

// @BeforeEachì—ì„œ ìºì‹œ ì´ˆê¸°í™”
@BeforeEach
void setUp() {
    cache.clear();
    redisTemplate.delete(redisTemplate.keys("test-*"));
}
```

### 4.3 Warm/Cold ìºì‹œ ë¶„ë¦¬

| ìƒíƒœ | ì •ì˜ | í…ŒìŠ¤íŠ¸ ëª©ì  |
|------|------|------------|
| **Cold** | ìºì‹œ ë¹„ì–´ìˆìŒ | ìµœì•… ì‹œë‚˜ë¦¬ì˜¤, DB ë¶€í•˜ ê²€ì¦ |
| **Warm** | ìºì‹œ ì±„ì›Œì§ (80%+ HIT) | ì¼ë°˜ ìš´ì˜ ì‹œë‚˜ë¦¬ì˜¤ |

```bash
# Cold í…ŒìŠ¤íŠ¸
> redis-cli FLUSHALL
locust -f locustfile.py --tags v3 -u 50 -t 60s

# Warm í…ŒìŠ¤íŠ¸
curl http://localhost:8080/api/v3/characters/ê°•ì€í˜¸/expectation  # í”„ë¼ì´ë°
locust -f locustfile.py --tags v3 -u 50 -t 60s
```

---

## 5. ì¥ì•  ì£¼ì… Best Practice

### 5.1 ë¹„ê¶Œì¥ ë°©ë²• (í˜„ì‹¤ì„± ë¶€ì¡±)

| ë°©ë²• | ë¬¸ì œì  | ëŒ€ì•ˆ |
|------|--------|------|
| `FLUSHALL` | Redis ì „ì²´ ì‚­ì œëŠ” ìš´ì˜ì—ì„œ ë°œìƒí•˜ì§€ ì•ŠìŒ | íŠ¹ì • í‚¤ ë§Œë£Œ/ì‚­ì œ |
| `FLUSHDB` | DB ì „ì²´ ì‚­ì œëŠ” ë¹„í˜„ì‹¤ì  ì‹œë‚˜ë¦¬ì˜¤ | íŠ¹ì • í…Œì´ë¸” TRUNCATE |
| ì„œë¹„ìŠ¤ ì¤‘ì§€ | ì¸í”„ë¼ ì¥ì• ë§Œ í…ŒìŠ¤íŠ¸, ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ íƒ„ë ¥ì„± ë¯¸ê²€ì¦ | íƒ€ì„ì•„ì›ƒ/ì„œí‚·ë¸Œë ˆì´ì»¤ |

### 5.2 ê¶Œì¥ ì¥ì•  ì£¼ì… ë°©ë²•

| ì‹œë‚˜ë¦¬ì˜¤ | ë°©ë²• | ëª…ë ¹ì–´/ì½”ë“œ | ê²€ì¦ ëª©ì  |
|---------|------|------------|---------|
| **íŠ¹ì • ìºì‹œ ë§Œë£Œ** | TTL ì„¤ì • | `SET key val EX 1` | Cache Miss ì‹œ ë™ì‘ |
| **íŠ¹ì • í‚¤ ì‚­ì œ** | DEL ì‚¬ìš© | `DEL specific:key` | íŠ¹ì • ë°ì´í„°ë§Œ ë¬´íš¨í™” |
| **L1ë§Œ ë¬´íš¨í™”** | Caffeine API | `cache.invalidate(key)` | L2ê°€ ì‚´ì•„ìˆì„ ë•Œ ë™ì‘ |
| **L2ë§Œ ë¬´íš¨í™”** | Redis DEL | `redisTemplate.delete(key)` | L1ì´ ì‚´ì•„ìˆì„ ë•Œ ë™ì‘ |
| **L1+L2 ë¬´íš¨í™”** | ìˆœì°¨ ì‚­ì œ | L1.invalidate() + Redis.delete() | ì§„ì •í•œ Cache Stampede |
| **ë„¤íŠ¸ì›Œí¬ ì§€ì—°** | TC/netem | `tc qdisc add dev eth0 root netem delay 100ms` | íƒ€ì„ì•„ì›ƒ/íšŒë³µì„± |
| **ì™¸ë¶€ API ì¥ì• ** | WireMock | `stubFor(api.toRespond(serverError()))` | Fallback/CircuitBreaker |

### 5.3 ê³„ì¸µë³„ í…ŒìŠ¤íŠ¸ ë¶„ë¦¬ (TieredCache)

```java
// L1ë§Œ ë¬´íš¨í™”: L2ê°€ ì‚´ì•„ìˆì„ ë•Œ ë™ì‘ í™•ì¸
@Test
void invalidateL1_only_L2StillsAlive() {
    // Given: L1+L2ì— ë°ì´í„° ì¡´ì¬
    tieredCache.get(key, loader);

    // When: L1ë§Œ ë¬´íš¨í™”
    l1Cache.invalidate(key);

    // Then: L2ì—ì„œ HIT (DB ì¡°íšŒ ì—†ìŒ)
    assertThat(tieredCache.get(key, loader)).isNotNull();
    verify(loader, never()).load(key);  // DB ë¯¸í˜¸ì¶œ
}

// L2ë§Œ ë¬´íš¨í™”: L1ì´ ì‚´ì•„ìˆì„ ë•Œ ë™ì‘ í™•ì¸
@Test
void invalidateL2_only_L1StillsAlive() {
    // Given: L1+L2ì— ë°ì´í„° ì¡´ì¬
    tieredCache.get(key, loader);

    // When: L2ë§Œ ë¬´íš¨í™”
    redisTemplate.delete(key);

    // Then: L1ì—ì„œ HIT (DB ì¡°íšŒ ì—†ìŒ)
    assertThat(tieredCache.get(key, loader)).isNotNull();
    verify(loader, never()).load(key);  // DB ë¯¸í˜¸ì¶œ
}

// L1+L2 ë¬´íš¨í™”: ì§„ì •í•œ Cache Stampede ì‹œë‚˜ë¦¬ì˜¤
@Test
void invalidateL1AndL2_onlyOneDBCall() throws Exception {
    // Given: L1+L2ì— ë°ì´í„° ì¡´ì¬
    tieredCache.get(key, loader);

    // When: L1+L2 ë™ì‹œ ë¬´íš¨í™”
    l1Cache.invalidate(key);
    redisTemplate.delete(key);

    // When: 100ê°œ ë™ì‹œ ìš”ì²­
    int threadCount = 100;
    CountDownLatch latch = new CountDownLatch(threadCount);
    ExecutorService executor = Executors.newFixedThreadPool(threadCount);

    for (int i = 0; i < threadCount; i++) {
        executor.submit(() -> {
            tieredCache.get(key, loader);
            latch.countDown();
        });
    }
    latch.await(5, TimeUnit.SECONDS);

    // Then: DBëŠ” ì •í™•íˆ 1íšŒë§Œ í˜¸ì¶œ (Singleflight)
    verify(loader, times(1)).load(key);
}
```

### 5.4 í˜„ì‹¤ì ì¸ ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤ ì˜ˆì‹œ

| ì‹œë‚˜ë¦¬ì˜¤ | ì¬í˜„ ë°©ë²• | ê¸°ëŒ€ ë™ì‘ |
|---------|----------|---------|
| **Redis ì¥ì•  ë³µêµ¬ í›„ ìºì‹œ ë¶ˆì¼ì¹˜** | Redis ì¤‘ì§€ â†’ 30ì´ˆ í›„ ì¬ì‹œì‘ â†’ ìš”ì²­ | L1ë§Œ HIT, L2 MISS í›„ ìë™ ë³µêµ¬ |
| **íŠ¹ì • ì¸ê¸° ìºì‹œ ë§Œë£Œ** | `DEL character:ê°•ì€í˜¸` | Singleflightë¡œ DB 1íšŒ ì¡°íšŒ í›„ ìºì‹œ ì¬êµ¬ì¶• |
| **L1/L2 ë™ì‹œ ë§Œë£Œ (Race)** | L1.invalidate() â†’ sleep(10ms) â†’ Redis.delete() | ë™ì‹œ ìš”ì²­ ì‹œì—ë„ DB 1íšŒë§Œ ì¡°íšŒ |

---

## 6. 5ê°œ Agent í…ŒìŠ¤íŠ¸ ì±…ì„

### 6.1 Blue Agent (Spring-Architect)

**ê²€ì¦ ì˜ì—­:** ì•„í‚¤í…ì²˜ ì¤€ìˆ˜, SOLID ì›ì¹™, ë””ìì¸ íŒ¨í„´

| í…ŒìŠ¤íŠ¸ | ê²€ì¦ ë‚´ìš© |
|--------|----------|
| Facade Self-invocation íšŒí”¼ | AOP í”„ë¡ì‹œ ìš°íšŒ ë°©ì§€ |
| ê³„ì¸µ ë¶„ë¦¬ | Controller â†’ Service â†’ Repository ë‹¨ë°©í–¥ |
| DIP ì¤€ìˆ˜ | ì¸í„°í˜ì´ìŠ¤ ì˜ì¡´, êµ¬í˜„ì²´ ì£¼ì… |

### 6.2 Green Agent (Performance-Guru)

**ê²€ì¦ ì˜ì—­:** ì„±ëŠ¥, ì•Œê³ ë¦¬ì¦˜ ë³µì¡ë„, ìºì‹œ íš¨ìœ¨

| í…ŒìŠ¤íŠ¸ | ê²€ì¦ ë‚´ìš© | SLA |
|--------|----------|-----|
| Cache HIT ë¹„ìœ¨ | L1/L2 HIT ë¹„ìœ¨ | > 80% |
| Single-flight | ë™ì‹œ ìš”ì²­ ì‹œ loader 1íšŒ | < 5íšŒ |
| O(n) ì•Œê³ ë¦¬ì¦˜ | DP ë³µì¡ë„ ê²€ì¦ | < 100ms for target=500 |

### 6.3 Yellow Agent (QA-Master)

**ê²€ì¦ ì˜ì—­:** í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€, ê²½ê³„ê°’, ì˜ˆì™¸ ì²˜ë¦¬

| í…ŒìŠ¤íŠ¸ | ê²€ì¦ ë‚´ìš© |
|--------|----------|
| 21ê°œ ì»¤ìŠ¤í…€ ì˜ˆì™¸ | ê° ì˜ˆì™¸ ë°œìƒ ì‹œë‚˜ë¦¬ì˜¤ |
| ê²½ê³„ê°’ | null, ë¹ˆ ë¬¸ìì—´, ìµœëŒ€ê°’ |
| ë™ì‹œì„± | CountDownLatch + awaitTermination |

### 6.4 Purple Agent (Financial-Grade-Auditor)

**ê²€ì¦ ì˜ì—­:** ë°ì´í„° ë¬´ê²°ì„±, ë³´ì•ˆ, ì •ë°€ ê³„ì‚°

| í…ŒìŠ¤íŠ¸ | ê²€ì¦ ë‚´ìš© |
|--------|----------|
| Kahan Summation ì •ë°€ë„ | double ì˜¤ì°¨ ëˆ„ì  ë°©ì§€ ê²€ì¦ |
| API Key ë§ˆìŠ¤í‚¹ | toString() í‰ë¬¸ ë…¸ì¶œ ê¸ˆì§€ |
| í™•ë¥  í•©ê³„ ë¶ˆë³€ì‹ | Î£prob = 1.0 (ì˜¤ì°¨ë²”ìœ„ 10^-12) |

### 6.5 Red Agent (SRE-Gatekeeper)

**ê²€ì¦ ì˜ì—­:** íšŒë³µ íƒ„ë ¥ì„±, íƒ€ì„ì•„ì›ƒ, Graceful Degradation

| í…ŒìŠ¤íŠ¸ | ê²€ì¦ ë‚´ìš© |
|--------|----------|
| CircuitBreaker ìƒíƒœ ì „ì´ | CLOSED â†’ OPEN â†’ HALF_OPEN â†’ CLOSED |
| Watchdog ëª¨ë“œ | leaseTime ì—†ì´ ìë™ ê°±ì‹  |
| Graceful Shutdown | 4ë‹¨ê³„ ìˆœì°¨ ì¢…ë£Œ |
| AbortPolicy | í í¬í™” ì‹œ 503 ë°˜í™˜ |

---

## 7. ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ë° ë¶„ì„

### 7.1 í•„ìˆ˜ ë©”íŠ¸ë¦­

| ë©”íŠ¸ë¦­ | ìˆ˜ì§‘ ë°©ë²• | ì„ê³„ê°’ |
|--------|----------|--------|
| `cache.hit{layer=L1}` | Micrometer Counter | - |
| `cache.hit{layer=L2}` | Micrometer Counter | - |
| `cache.miss` | Micrometer Counter | - |
| `executor.rejected` | Custom Counter | 0 |
| `circuitbreaker.state` | Resilience4j | CLOSED |

### 7.2 ë¶€í•˜ í…ŒìŠ¤íŠ¸ ë¦¬í¬íŠ¸ í…œí”Œë¦¿

```
======================================================================
Test Summary - 2026-01-14 14:30:00
======================================================================
Environment: local (JVM -Xmx512m, Redis 256mb)
Cache State: warm (80% HIT)
Duration: 60s
Users: 50
Spawn Rate: 10/s
----------------------------------------------------------------------
Total Requests: 12,345
Failures: 12 (0.10%)
----------------------------------------------------------------------
Response Time:
  Median: 160ms
  P95: 450ms
  P99: 890ms
----------------------------------------------------------------------
RPS: 235
----------------------------------------------------------------------
Cache Metrics:
  L1 HIT: 8,500 (68.8%)
  L2 HIT: 2,000 (16.2%)
  MISS: 1,845 (15.0%)
----------------------------------------------------------------------
Failure Breakdown:
  Server Error (5xx): 0
  Client Error (4xx): 0
  Business Error: 12 (DuplicateLikeException)
======================================================================
```

---

## 8. CI/CD í†µí•©

### 8.1 í…ŒìŠ¤íŠ¸ ë‹¨ê³„

```yaml
# GitHub Actions ì˜ˆì‹œ
test:
  stage: test
  steps:
    - name: Unit Tests
      run: ./gradlew test --tests '*UnitTest'
      timeout: 10m

    - name: Integration Tests
      run: ./gradlew test --tests '*IntegrationTest'
      timeout: 20m
      services:
        - mysql:8.0
        - redis:7

    - name: Load Tests (Smoke)
      run: locust -f locust/locustfile.py --headless -u 10 -r 5 -t 30s
      continue-on-error: false
```

### 8.2 í’ˆì§ˆ ê²Œì´íŠ¸

| ê²Œì´íŠ¸ | ì¡°ê±´ | ì‹¤íŒ¨ ì‹œ |
|--------|------|--------|
| **Unit Test** | 100% í†µê³¼ | ë¹Œë“œ ì‹¤íŒ¨ |
| **Integration Test** | 100% í†µê³¼ | ë¹Œë“œ ì‹¤íŒ¨ |
| **Coverage** | > 70% | ê²½ê³  |
| **Load Test Error Rate** | < 1% | ë°°í¬ ì°¨ë‹¨ |

---

## 9. ê´€ë ¨ íŒŒì¼

| íŒŒì¼ | ìš©ë„ |
|------|------|
| `locust/locustfile.py` | ë¶€í•˜ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ |
| `src/test/java/**/support/IntegrationTestSupport.java` | í†µí•© í…ŒìŠ¤íŠ¸ ë² ì´ìŠ¤ |
| `src/test/java/**/support/AbstractContainerBaseTest.java` | Testcontainers ë² ì´ìŠ¤ |
| `docs/PERFORMANCE_260105.md` | ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ê²°ê³¼ |

---

## 10. 5-Agent Council í˜‘ì—… ê°€ì´ë“œ

### 10.1 ë¬¸ì„œ ì‘ì„± ì‹œ ì—ì´ì „íŠ¸ë³„ ì—­í• 

| ì—ì´ì „íŠ¸ | ì—­í•  | ê²€ì¦ í¬ì¸íŠ¸ | ì‚°ì¶œë¬¼ |
|---------|------|------------|--------|
| ğŸ”´ **Red** (SRE-Gatekeeper) | ì¥ì•  ì£¼ì… ì„¤ê³„ | í˜„ì‹¤ì ì¸ ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤, ìš´ì˜ í™˜ê²½ ë°˜ì˜ | ì¥ì•  ì£¼ì… ì‹œë‚˜ë¦¬ì˜¤ ëª©ë¡ |
| ğŸ”µ **Blue** (Spring-Architect) | ì•„í‚¤í…ì²˜ ê²€ì¦ | ì½”ë“œ-ë¬¸ì„œ ì¼ì¹˜ì„±, ê³„ì¸µ ë¶„ë¦¬ ì¤€ìˆ˜ | ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨, ëª¨ë“ˆ ì˜ì¡´ì„± |
| ğŸŸ¢ **Green** (Performance-Guru) | ì„±ëŠ¥ ê¸°ì¤€ ì„¤ì • | ì¸¡ì • ê°€ëŠ¥í•œ ë©”íŠ¸ë¦­, SLA ì •ì˜ | ì„±ëŠ¥ ê¸°ì¤€í‘œ, ë¶€í•˜ í…ŒìŠ¤íŠ¸ ê²°ê³¼ |
| ğŸŸ£ **Purple** (Financial-Grade-Auditor) | ë°ì´í„° ë¬´ê²°ì„± | ì¼ê´€ì„± ê²€ì¦, ì •ë°€ë„ ê¸°ì¤€ | ë°ì´í„° ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸ |
| ğŸŸ¡ **Yellow** (QA-Master) | í…ŒìŠ¤íŠ¸ ì™„ê²°ì„± | PASS/FAIL ëª…í™•ì„±, ì¬í˜„ì„± ë³´ì¥ | í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤, ê²°ê³¼ ë¦¬í¬íŠ¸ |

### 10.2 ì¹´ì˜¤ìŠ¤ ë¦¬í¬íŠ¸ ì‘ì„± ì›Œí¬í”Œë¡œìš°

```mermaid
graph TD
    A[Red: ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤ ì •ì˜] --> B[Blue: ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨]
    B --> C[Green: ì„±ëŠ¥ ë©”íŠ¸ë¦­ ì„¤ì •]
    C --> D[Purple: ë°ì´í„° ê²€ì¦ ê¸°ì¤€]
    D --> E[Yellow: í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë° ë¦¬í¬íŠ¸]
    E --> F[Red: ê²°ê³¼ ê²€ì¦ ë° í”¼ë“œë°±]
    F --> G[ë¬¸ì„œ ì—…ë°ì´íŠ¸]

    style A fill:#ff6b6b
    style B fill:#4dabf7
    style C fill:#51cf66
    style D fill:#cc5de8
    style E fill:#ffd93d
    style F fill:#ff6b6b
    style G fill:#adb5bd
```

### 10.3 ì—ì´ì „íŠ¸ë³„ í˜‘ì—… ì²´í¬ë¦¬ìŠ¤íŠ¸

#### ğŸ”´ Red Agent (ì¥ì•  ì£¼ì… ì„¤ê³„)
- [ ] í˜„ì‹¤ì ì¸ ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤ì¸ê°€? (FLUSHALL/FLUSHDB ë¯¸ì‚¬ìš©)
- [ ] ê³„ì¸µë³„ ì¥ì•  ì£¼ì…ì´ ë¶„ë¦¬ë˜ì–´ ìˆëŠ”ê°€? (L1, L2, DB)
- [ ] ìš´ì˜ í™˜ê²½ì—ì„œ ë°œìƒ ê°€ëŠ¥í•œ ì¥ì• ì¸ê°€?
- [ ] ì¥ì•  ë³µêµ¬ ì ˆì°¨ê°€ ë¬¸ì„œí™”ë˜ì–´ ìˆëŠ”ê°€?

#### ğŸ”µ Blue Agent (ì•„í‚¤í…ì²˜ ê²€ì¦)
- [ ] ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ì´ ìµœì‹  ì½”ë“œì™€ ì¼ì¹˜í•˜ëŠ”ê°€?
- [ ] ê³„ì¸µ ë¶„ë¦¬ (Controller â†’ Service â†’ Repository)ì´ ì¤€ìˆ˜ë˜ëŠ”ê°€?
- [ ] AOP í”„ë¡ì‹œ ìš°íšŒ (Self-invocation)ê°€ ì—†ëŠ”ê°€?
- [ ] ìˆœí™˜ ì˜ì¡´ì„±ì´ ì—†ëŠ”ê°€?

#### ğŸŸ¢ Green Agent (ì„±ëŠ¥ ê¸°ì¤€ ì„¤ì •)
- [ ] ë©”íŠ¸ë¦­ì´ ì •ëŸ‰ì ìœ¼ë¡œ ì¸¡ì • ê°€ëŠ¥í•œê°€? (P95, P99, RPS)
- [ ] Singleflight íš¨ê³¼ê°€ ê²€ì¦ ê°€ëŠ¥í•œê°€? (DB ì¿¼ë¦¬ â‰¤ 1%)
- [ ] SLA ê¸°ì¤€ì´ í˜„ì‹¤ì ì¸ê°€? (P95 < 3000ms)
- [ ] Before/After ë¹„êµ ë°ì´í„°ê°€ ìˆëŠ”ê°€?

#### ğŸŸ£ Purple Agent (ë°ì´í„° ë¬´ê²°ì„±)
- [ ] ë°ì´í„° ì¼ê´€ì„± ê²€ì¦ ê¸°ì¤€ì´ ìˆëŠ”ê°€?
- [ ] í™•ë¥  í•©ê³„ ë¶ˆë³€ì‹ (Î£prob = 1.0)ì´ ê²€ì¦ë˜ëŠ”ê°€?
- [ ] ë™ì‹œì„± ìƒí™©ì—ì„œ ë°ì´í„° ë¬´ê²°ì„±ì´ ë³´ì¥ë˜ëŠ”ê°€?
- [ ] ì •ë°€ë„ ìš”êµ¬ì‚¬í•­ì´ ì •ì˜ë˜ì–´ ìˆëŠ”ê°€?

#### ğŸŸ¡ Yellow Agent (í…ŒìŠ¤íŠ¸ ì™„ê²°ì„±)
- [ ] PASS/FAIL ê¸°ì¤€ì´ ëª…í™•í•œê°€?
- [ ] í…ŒìŠ¤íŠ¸ê°€ ì¬í˜„ ê°€ëŠ¥í•œê°€? (í™˜ê²½ ê³ ì •, ë°ì´í„° ê²©ë¦¬)
- [ ] ê²½ê³„ê°’ í…ŒìŠ¤íŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ê°€? (null, ë¹ˆ ê°’, ìµœëŒ€ê°’)
- [ ] Flaky Test ë°©ì§€ ì¡°ì¹˜ê°€ ë˜ì–´ ìˆëŠ”ê°€?

### 10.4 ë©€í‹° ì—ì´ì „íŠ¸ ë¦¬ë·° í”„ë¡œì„¸ìŠ¤

```yaml
# .github/PULL_REQUEST_TEMPLATE/chaos_report_review.md
chaos_report_review:
  reviewers:
    required:
      - red_agent   # ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤ í˜„ì‹¤ì„± ê²€ì¦
      - blue_agent  # ì•„í‚¤í…ì²˜ ì •í•©ì„± ê²€ì¦
      - green_agent  # ì„±ëŠ¥ ê¸°ì¤€ ì¶©ì¡± ì—¬ë¶€ ê²€ì¦

  checklist:
    red_agent:
      - [ ] ìš´ì˜ í™˜ê²½ì—ì„œ ë°œìƒ ê°€ëŠ¥í•œ ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤
      - [ ] ê³„ì¸µë³„ ì¥ì•  ì£¼ì… ë¶„ë¦¬ (L1, L2, DB)
      - [ ] ë³µêµ¬ ì ˆì°¨ ë¬¸ì„œí™”

    blue_agent:
      - [ ] ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ê³¼ ì½”ë“œ ì¼ì¹˜
      - [ ] SOLID ì›ì¹™ ì¤€ìˆ˜
      - [ ] ìˆœí™˜ ì˜ì¡´ì„± ì—†ìŒ

    green_agent:
      - [ ] ë©”íŠ¸ë¦­ ì •ëŸ‰ì  ì¸¡ì • ê°€ëŠ¥
      - [ ] SLA ê¸°ì¤€ ì¶©ì¡± (Error Rate < 1%)
      - [ ] Before/After ë¹„êµ ë°ì´í„° ì¡´ì¬

    purple_agent:
      - [ ] ë°ì´í„° ì¼ê´€ì„± ê²€ì¦ ê¸°ì¤€
      - [ ] ë™ì‹œì„± ë¬´ê²°ì„± ë³´ì¥
      - [ ] ì •ë°€ë„ ê¸°ì¤€ ì •ì˜

    yellow_agent:
      - [ ] PASS/FAIL ê¸°ì¤€ ëª…í™•
      - [ ] í…ŒìŠ¤íŠ¸ ì¬í˜„ì„± ë³´ì¥
      - [ ] ê²½ê³„ê°’ í…ŒìŠ¤íŠ¸ í¬í•¨
```

---

## ë³€ê²½ ì´ë ¥

| ë‚ ì§œ | ë²„ì „ | ë³€ê²½ ë‚´ìš© |
|------|------|----------|
| 2026-01-14 | 1.0 | ì´ˆê¸° ì‘ì„± - ì´ë¬´ ê´€ì  í…ŒìŠ¤íŠ¸ ì²´ê³„ |
| 2026-02-18 | 1.1 | ì¥ì•  ì£¼ì… Best Practice ì„¹ì…˜ ì¶”ê°€ (ì„¹ì…˜ 5) |
| 2026-02-18 | 1.1 | Cache Stampede ê²€ì¦ ê¸°ì¤€ ê°•í™” (ì„¹ì…˜ 3.4) |
| 2026-02-18 | 1.1 | 5-Agent Council í˜‘ì—… ê°€ì´ë“œ ì¶”ê°€ (ì„¹ì…˜ 10) |
| 2026-02-18 | 1.1 | ì„¹ì…˜ ë²ˆí˜¸ ì¬ì •ë¦¬ (1-10ê¹Œì§€ ìˆœì°¨ì  ë°°ì¹˜) |
